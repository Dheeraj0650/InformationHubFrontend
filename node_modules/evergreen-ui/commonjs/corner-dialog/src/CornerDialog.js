'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _propTypes = require('prop-types');

var _propTypes2 = _interopRequireDefault(_propTypes);

var _uiBox = require('ui-box');

var _Transition = require('react-transition-group/Transition');

var _Transition2 = _interopRequireDefault(_Transition);

var _layers = require('../../layers');

var _portal = require('../../portal');

var _typography = require('../../typography');

var _buttons = require('../../buttons');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var animationEasing = {
  deceleration: 'cubic-bezier(0.0, 0.0, 0.2, 1)',
  acceleration: 'cubic-bezier(0.4, 0.0, 1, 1)',
  spring: 'cubic-bezier(0.175, 0.885, 0.320, 1.175)'
};

var ANIMATION_DURATION = 240;

var openAnimation = _uiBox.css.keyframes('openAnimation', {
  from: {
    transform: 'translateY(100%)'
  },
  to: {
    transform: 'translateY(0)'
  }
});

var closeAnimation = _uiBox.css.keyframes('closeAnimation', {
  from: {
    transform: 'scale(1)',
    opacity: 1
  },
  to: {
    transform: 'scale(0.9)',
    opacity: 0
  }
});

var animationStyles = {
  '&[data-state="entering"], &[data-state="entered"]': {
    animation: openAnimation + ' ' + ANIMATION_DURATION + 'ms ' + animationEasing.spring + ' both'
  },
  '&[data-state="exiting"]': {
    animation: closeAnimation + ' 120ms ' + animationEasing.acceleration + ' both'
  }
};

var CornerDialog = function (_PureComponent) {
  _inherits(CornerDialog, _PureComponent);

  function CornerDialog() {
    _classCallCheck(this, CornerDialog);

    var _this = _possibleConstructorReturn(this, (CornerDialog.__proto__ || Object.getPrototypeOf(CornerDialog)).call(this));

    _this.handleHidden = function () {
      _this.setState({ exiting: false });
      _this.props.onHide();

      if (_this.props.onExited) {
        var _this$props;

        (_this$props = _this.props).onExited.apply(_this$props, arguments);
      }
    };

    _this.handleClose = function () {
      _this.setState({ exiting: true });
      _this.props.onHide();
    };

    _this.state = {
      exiting: false
    };
    return _this;
  }

  _createClass(CornerDialog, [{
    key: 'render',
    value: function render() {
      var _this2 = this;

      var _props = this.props,
          children = _props.children,
          width = _props.width,
          height = _props.height,
          hasCloseIcon = _props.hasCloseIcon,
          containerProps = _props.containerProps,
          isShown = _props.isShown,
          title = _props.title,
          onExit = _props.onExit,
          onExiting = _props.onExiting,
          onEnter = _props.onEnter,
          onEntering = _props.onEntering,
          onEntered = _props.onEntered;
      var exiting = this.state.exiting;


      return _react2.default.createElement(
        _portal.Portal,
        null,
        _react2.default.createElement(
          _Transition2.default,
          {
            appear: true,
            unmountOnExit: true,
            timeout: ANIMATION_DURATION,
            'in': isShown && !exiting,
            onExit: onExit,
            onExiting: onExiting,
            onExited: this.handleHidden,
            onEnter: onEnter,
            onEntering: onEntering,
            onEntered: onEntered
          },
          function (state) {
            return _react2.default.createElement(
              _layers.Pane,
              _extends({
                role: 'dialog',
                backgroundColor: 'white',
                elevation: 4,
                borderRadius: 8,
                width: width,
                height: height,
                css: animationStyles,
                'data-state': state,
                position: 'fixed',
                bottom: 8,
                right: 8
              }, containerProps),
              _react2.default.createElement(
                _layers.Pane,
                {
                  padding: 8,
                  borderBottom: 'extraMuted',
                  display: 'flex',
                  alignItems: 'center'
                },
                _react2.default.createElement(
                  _typography.Heading,
                  { is: 'h4', size: 500, flex: '1' },
                  title
                ),
                hasCloseIcon && _react2.default.createElement(_buttons.IconButton, {
                  height: 24,
                  icon: 'close',
                  appearance: 'ghost',
                  onClick: _this2.handleClose
                })
              ),
              _react2.default.createElement(
                _layers.Pane,
                { overflowY: 'auto', 'data-state': state, padding: 8 },
                typeof children === 'function' ? children({
                  close: close
                }) : children
              )
            );
          }
        )
      );
    }
  }]);

  return CornerDialog;
}(_react.PureComponent);

CornerDialog.propTypes = {
  title: _propTypes2.default.node,
  width: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.number]),
  height: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.number]),
  isShown: _propTypes2.default.bool,
  children: _propTypes2.default.node,
  hasCloseIcon: _propTypes2.default.bool,
  containerProps: _propTypes2.default.object,

  onHide: _propTypes2.default.func,
  onExit: _propTypes2.default.func,
  onExiting: _propTypes2.default.func,
  onExited: _propTypes2.default.func,
  onEnter: _propTypes2.default.func,
  onEntering: _propTypes2.default.func,
  onEntered: _propTypes2.default.func
};
CornerDialog.defaultProps = {
  onHide: function onHide() {},
  width: 320,
  height: 176,
  hasCloseIcon: true
};
exports.default = CornerDialog;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb3JuZXItZGlhbG9nL3NyYy9Db3JuZXJEaWFsb2cuanMiXSwibmFtZXMiOlsiYW5pbWF0aW9uRWFzaW5nIiwiZGVjZWxlcmF0aW9uIiwiYWNjZWxlcmF0aW9uIiwic3ByaW5nIiwiQU5JTUFUSU9OX0RVUkFUSU9OIiwib3BlbkFuaW1hdGlvbiIsImtleWZyYW1lcyIsImZyb20iLCJ0cmFuc2Zvcm0iLCJ0byIsImNsb3NlQW5pbWF0aW9uIiwib3BhY2l0eSIsImFuaW1hdGlvblN0eWxlcyIsImFuaW1hdGlvbiIsIkNvcm5lckRpYWxvZyIsImhhbmRsZUhpZGRlbiIsInNldFN0YXRlIiwiZXhpdGluZyIsInByb3BzIiwib25IaWRlIiwib25FeGl0ZWQiLCJoYW5kbGVDbG9zZSIsInN0YXRlIiwiY2hpbGRyZW4iLCJ3aWR0aCIsImhlaWdodCIsImhhc0Nsb3NlSWNvbiIsImNvbnRhaW5lclByb3BzIiwiaXNTaG93biIsInRpdGxlIiwib25FeGl0Iiwib25FeGl0aW5nIiwib25FbnRlciIsIm9uRW50ZXJpbmciLCJvbkVudGVyZWQiLCJjbG9zZSIsInByb3BUeXBlcyIsIm5vZGUiLCJvbmVPZlR5cGUiLCJzdHJpbmciLCJudW1iZXIiLCJib29sIiwib2JqZWN0IiwiZnVuYyIsImRlZmF1bHRQcm9wcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBOzs7O0FBQ0E7Ozs7QUFDQTs7QUFDQTs7OztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7Ozs7O0FBRUEsSUFBTUEsa0JBQWtCO0FBQ3RCQyxnREFEc0I7QUFFdEJDLDhDQUZzQjtBQUd0QkM7QUFIc0IsQ0FBeEI7O0FBTUEsSUFBTUMscUJBQXFCLEdBQTNCOztBQUVBLElBQU1DLGdCQUFnQixXQUFJQyxTQUFKLENBQWMsZUFBZCxFQUErQjtBQUNuREMsUUFBTTtBQUNKQyxlQUFXO0FBRFAsR0FENkM7QUFJbkRDLE1BQUk7QUFDRkQsZUFBVztBQURUO0FBSitDLENBQS9CLENBQXRC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O0FBSmhCO0FBVkosZUFkRjtBQWlDRTtBQUFBO0FBQUEsa0JBQU0sV0FBVSxNQUFoQixFQUF1QixjQUFZQyxLQUFuQyxFQUEwQyxTQUFTLENBQW5EO0FBQ0csdUJBQU9DLFFBQVAsS0FBb0IsVUFBcEIsR0FDR0EsU0FBUztBQUNQWTtBQURPLGlCQUFULENBREgsR0FJR1o7QUFMTjtBQWpDRixhQUREO0FBQUE7QUFaSDtBQURGLE9BREY7QUE0REQ7Ozs7OztBQTlIa0JULFksQ0FDWnNCLFMsR0FBWTtBQUNqQlAsU0FBTyxvQkFBVVEsSUFEQTtBQUVqQmIsU0FBTyxvQkFBVWMsU0FBVixDQUFvQixDQUFDLG9CQUFVQyxNQUFYLEVBQW1CLG9CQUFVQyxNQUE3QixDQUFwQixDQUZVO0FBR2pCZixVQUFRLG9CQUFVYSxTQUFWLENBQW9CLENBQUMsb0JBQVVDLE1BQVgsRUFBbUIsb0JBQVVDLE1BQTdCLENBQXBCLENBSFM7QUFJakJaLFdBQVMsb0JBQVVhLElBSkY7QUFLakJsQixZQUFVLG9CQUFVYyxJQUxIO0FBTWpCWCxnQkFBYyxvQkFBVWUsSUFOUDtBQU9qQmQsa0JBQWdCLG9CQUFVZSxNQVBUOztBQVNqQnZCLFVBQVEsb0JBQVV3QixJQVREO0FBVWpCYixVQUFRLG9CQUFVYSxJQVZEO0FBV2pCWixhQUFXLG9CQUFVWSxJQVhKO0FBWWpCdkIsWUFBVSxvQkFBVXVCLElBWkg7QUFhakJYLFdBQVMsb0JBQVVXLElBYkY7QUFjakJWLGNBQVksb0JBQVVVLElBZEw7QUFlakJULGFBQVcsb0JBQVVTO0FBZkosQztBQURBN0IsWSxDQW1CWjhCLFksR0FBZTtBQUNwQnpCLFVBQVEsa0JBQU0sQ0FBRSxDQURJO0FBRXBCSyxTQUFPLEdBRmE7QUFHcEJDLFVBQVEsR0FIWTtBQUlwQkMsZ0JBQWM7QUFKTSxDO2tCQW5CSFosWSIsImZpbGUiOiJDb3JuZXJEaWFsb2cuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgUHVyZUNvbXBvbmVudCB9IGZyb20gJ3JlYWN0J1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJ1xuaW1wb3J0IHsgY3NzIH0gZnJvbSAndWktYm94J1xuaW1wb3J0IFRyYW5zaXRpb24gZnJvbSAncmVhY3QtdHJhbnNpdGlvbi1ncm91cC9UcmFuc2l0aW9uJ1xuaW1wb3J0IHsgUGFuZSB9IGZyb20gJy4uLy4uL2xheWVycydcbmltcG9ydCB7IFBvcnRhbCB9IGZyb20gJy4uLy4uL3BvcnRhbCdcbmltcG9ydCB7IEhlYWRpbmcgfSBmcm9tICcuLi8uLi90eXBvZ3JhcGh5J1xuaW1wb3J0IHsgSWNvbkJ1dHRvbiB9IGZyb20gJy4uLy4uL2J1dHRvbnMnXG5cbmNvbnN0IGFuaW1hdGlvbkVhc2luZyA9IHtcbiAgZGVjZWxlcmF0aW9uOiBgY3ViaWMtYmV6aWVyKDAuMCwgMC4wLCAwLjIsIDEpYCxcbiAgYWNjZWxlcmF0aW9uOiBgY3ViaWMtYmV6aWVyKDAuNCwgMC4wLCAxLCAxKWAsXG4gIHNwcmluZzogYGN1YmljLWJlemllcigwLjE3NSwgMC44ODUsIDAuMzIwLCAxLjE3NSlgXG59XG5cbmNvbnN0IEFOSU1BVElPTl9EVVJBVElPTiA9IDI0MFxuXG5jb25zdCBvcGVuQW5pbWF0aW9uID0gY3NzLmtleWZyYW1lcygnb3BlbkFuaW1hdGlvbicsIHtcbiAgZnJvbToge1xuICAgIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVkoMTAwJSknXG4gIH0sXG4gIHRvOiB7XG4gICAgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgwKSdcbiAgfVxufSlcblxuY29uc3QgY2xvc2VBbmltYXRpb24gPSBjc3Mua2V5ZnJhbWVzKCdjbG9zZUFuaW1hdGlvbicsIHtcbiAgZnJvbToge1xuICAgIHRyYW5zZm9ybTogJ3NjYWxlKDEpJyxcbiAgICBvcGFjaXR5OiAxXG4gIH0sXG4gIHRvOiB7XG4gICAgdHJhbnNmb3JtOiAnc2NhbGUoMC45KScsXG4gICAgb3BhY2l0eTogMFxuICB9XG59KVxuXG5jb25zdCBhbmltYXRpb25TdHlsZXMgPSB7XG4gICcmW2RhdGEtc3RhdGU9XCJlbnRlcmluZ1wiXSwgJltkYXRhLXN0YXRlPVwiZW50ZXJlZFwiXSc6IHtcbiAgICBhbmltYXRpb246IGAke29wZW5BbmltYXRpb259ICR7QU5JTUFUSU9OX0RVUkFUSU9OfW1zICR7XG4gICAgICBhbmltYXRpb25FYXNpbmcuc3ByaW5nXG4gICAgfSBib3RoYFxuICB9LFxuICAnJltkYXRhLXN0YXRlPVwiZXhpdGluZ1wiXSc6IHtcbiAgICBhbmltYXRpb246IGAke2Nsb3NlQW5pbWF0aW9ufSAxMjBtcyAke2FuaW1hdGlvbkVhc2luZy5hY2NlbGVyYXRpb259IGJvdGhgXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29ybmVyRGlhbG9nIGV4dGVuZHMgUHVyZUNvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgdGl0bGU6IFByb3BUeXBlcy5ub2RlLFxuICAgIHdpZHRoOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuc3RyaW5nLCBQcm9wVHlwZXMubnVtYmVyXSksXG4gICAgaGVpZ2h0OiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuc3RyaW5nLCBQcm9wVHlwZXMubnVtYmVyXSksXG4gICAgaXNTaG93bjogUHJvcFR5cGVzLmJvb2wsXG4gICAgY2hpbGRyZW46IFByb3BUeXBlcy5ub2RlLFxuICAgIGhhc0Nsb3NlSWNvbjogUHJvcFR5cGVzLmJvb2wsXG4gICAgY29udGFpbmVyUHJvcHM6IFByb3BUeXBlcy5vYmplY3QsXG5cbiAgICBvbkhpZGU6IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uRXhpdDogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25FeGl0aW5nOiBQcm9wVHlwZXMuZnVuYyxcbiAgICBvbkV4aXRlZDogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25FbnRlcjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25FbnRlcmluZzogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25FbnRlcmVkOiBQcm9wVHlwZXMuZnVuY1xuICB9XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBvbkhpZGU6ICgpID0+IHt9LFxuICAgIHdpZHRoOiAzMjAsXG4gICAgaGVpZ2h0OiAxNzYsXG4gICAgaGFzQ2xvc2VJY29uOiB0cnVlXG4gIH1cblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpXG5cbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgZXhpdGluZzogZmFsc2VcbiAgICB9XG4gIH1cblxuICBoYW5kbGVIaWRkZW4gPSAoLi4uYXJncykgPT4ge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBleGl0aW5nOiBmYWxzZSB9KVxuICAgIHRoaXMucHJvcHMub25IaWRlKClcblxuICAgIGlmICh0aGlzLnByb3BzLm9uRXhpdGVkKSB7XG4gICAgICB0aGlzLnByb3BzLm9uRXhpdGVkKC4uLmFyZ3MpXG4gICAgfVxuICB9XG5cbiAgaGFuZGxlQ2xvc2UgPSAoKSA9PiB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGV4aXRpbmc6IHRydWUgfSlcbiAgICB0aGlzLnByb3BzLm9uSGlkZSgpXG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge1xuICAgICAgY2hpbGRyZW4sXG4gICAgICB3aWR0aCxcbiAgICAgIGhlaWdodCxcbiAgICAgIGhhc0Nsb3NlSWNvbixcbiAgICAgIGNvbnRhaW5lclByb3BzLFxuICAgICAgaXNTaG93bixcbiAgICAgIHRpdGxlLFxuICAgICAgb25FeGl0LFxuICAgICAgb25FeGl0aW5nLFxuICAgICAgb25FbnRlcixcbiAgICAgIG9uRW50ZXJpbmcsXG4gICAgICBvbkVudGVyZWRcbiAgICB9ID0gdGhpcy5wcm9wc1xuXG4gICAgY29uc3QgeyBleGl0aW5nIH0gPSB0aGlzLnN0YXRlXG5cbiAgICByZXR1cm4gKFxuICAgICAgPFBvcnRhbD5cbiAgICAgICAgPFRyYW5zaXRpb25cbiAgICAgICAgICBhcHBlYXJcbiAgICAgICAgICB1bm1vdW50T25FeGl0XG4gICAgICAgICAgdGltZW91dD17QU5JTUFUSU9OX0RVUkFUSU9OfVxuICAgICAgICAgIGluPXtpc1Nob3duICYmICFleGl0aW5nfVxuICAgICAgICAgIG9uRXhpdD17b25FeGl0fVxuICAgICAgICAgIG9uRXhpdGluZz17b25FeGl0aW5nfVxuICAgICAgICAgIG9uRXhpdGVkPXt0aGlzLmhhbmRsZUhpZGRlbn1cbiAgICAgICAgICBvbkVudGVyPXtvbkVudGVyfVxuICAgICAgICAgIG9uRW50ZXJpbmc9e29uRW50ZXJpbmd9XG4gICAgICAgICAgb25FbnRlcmVkPXtvbkVudGVyZWR9XG4gICAgICAgID5cbiAgICAgICAgICB7c3RhdGUgPT4gKFxuICAgICAgICAgICAgPFBhbmVcbiAgICAgICAgICAgICAgcm9sZT1cImRpYWxvZ1wiXG4gICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcj1cIndoaXRlXCJcbiAgICAgICAgICAgICAgZWxldmF0aW9uPXs0fVxuICAgICAgICAgICAgICBib3JkZXJSYWRpdXM9ezh9XG4gICAgICAgICAgICAgIHdpZHRoPXt3aWR0aH1cbiAgICAgICAgICAgICAgaGVpZ2h0PXtoZWlnaHR9XG4gICAgICAgICAgICAgIGNzcz17YW5pbWF0aW9uU3R5bGVzfVxuICAgICAgICAgICAgICBkYXRhLXN0YXRlPXtzdGF0ZX1cbiAgICAgICAgICAgICAgcG9zaXRpb249XCJmaXhlZFwiXG4gICAgICAgICAgICAgIGJvdHRvbT17OH1cbiAgICAgICAgICAgICAgcmlnaHQ9ezh9XG4gICAgICAgICAgICAgIHsuLi5jb250YWluZXJQcm9wc31cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPFBhbmVcbiAgICAgICAgICAgICAgICBwYWRkaW5nPXs4fVxuICAgICAgICAgICAgICAgIGJvcmRlckJvdHRvbT1cImV4dHJhTXV0ZWRcIlxuICAgICAgICAgICAgICAgIGRpc3BsYXk9XCJmbGV4XCJcbiAgICAgICAgICAgICAgICBhbGlnbkl0ZW1zPVwiY2VudGVyXCJcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxIZWFkaW5nIGlzPVwiaDRcIiBzaXplPXs1MDB9IGZsZXg9XCIxXCI+XG4gICAgICAgICAgICAgICAgICB7dGl0bGV9XG4gICAgICAgICAgICAgICAgPC9IZWFkaW5nPlxuICAgICAgICAgICAgICAgIHtoYXNDbG9zZUljb24gJiYgKFxuICAgICAgICAgICAgICAgICAgPEljb25CdXR0b25cbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PXsyNH1cbiAgICAgICAgICAgICAgICAgICAgaWNvbj1cImNsb3NlXCJcbiAgICAgICAgICAgICAgICAgICAgYXBwZWFyYW5jZT1cImdob3N0XCJcbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5oYW5kbGVDbG9zZX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgPC9QYW5lPlxuXG4gICAgICAgICAgICAgIDxQYW5lIG92ZXJmbG93WT1cImF1dG9cIiBkYXRhLXN0YXRlPXtzdGF0ZX0gcGFkZGluZz17OH0+XG4gICAgICAgICAgICAgICAge3R5cGVvZiBjaGlsZHJlbiA9PT0gJ2Z1bmN0aW9uJ1xuICAgICAgICAgICAgICAgICAgPyBjaGlsZHJlbih7XG4gICAgICAgICAgICAgICAgICAgICAgY2xvc2VcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgIDogY2hpbGRyZW59XG4gICAgICAgICAgICAgIDwvUGFuZT5cbiAgICAgICAgICAgIDwvUGFuZT5cbiAgICAgICAgICApfVxuICAgICAgICA8L1RyYW5zaXRpb24+XG4gICAgICA8L1BvcnRhbD5cbiAgICApXG4gIH1cbn1cbiJdfQ==